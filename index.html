<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Cycle Protocol Tracker</title>
<!-- Fixed CDN Links -->
<script src="https://cdn.tailwindcss.com"></script>
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
.no-scrollbar::-webkit-scrollbar { display: none; }
</style>
</head>
<body class="bg-gray-50 text-slate-900">
<div id="root"></div>

<script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    const DATA = [
        { date: "3-Mar", wk: 1, day: "Mon", test: "250mg (1mL)", primo: "100mg (0mL)", anavar: "0mg", ai: "-", total: "2mL" },
        { date: "5-Mar", wk: 1, day: "Wed", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "2mL" },
        { date: "7-Mar", wk: 1, day: "Fri", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "2mL" },
        { date: "10-Mar", wk: 2, day: "Mon", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "2mL" },
        { date: "12-Mar", wk: 2, day: "Wed", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "2mL" },
        { date: "14-Mar", wk: 2, day: "Fri", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "2mL" },
        { date: "17-Mar", wk: 3, day: "Mon", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "2mL" },
        { date: "19-Mar", wk: 3, day: "Wed", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "2mL" },
        { date: "21-Mar", wk: 3, day: "Fri", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "2mL" },
        { date: "24-Mar", wk: 4, day: "Mon", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "3mL" },
        { date: "26-Mar", wk: 4, day: "Wed", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "3mL" },
        { date: "28-Mar", wk: 4, day: "Fri", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "3mL" },
        { date: "31-Mar", wk: 5, day: "Mon", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "3mL" },
        { date: "2-Apr", wk: 5, day: "Wed", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "3mL" },
        { date: "4-Apr", wk: 5, day: "Fri", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "3mL" },
        { date: "7-Apr", wk: 6, day: "Mon", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "3mL" },
        { date: "9-Apr", wk: 6, day: "Wed", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "3mL" },
        { date: "11-Apr", wk: 6, day: "Fri", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "3mL" },
        { date: "14-Apr", wk: 7, day: "Mon", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "3mL" },
        { date: "16-Apr", wk: 7, day: "Wed", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "3mL" },
        { date: "18-Apr", wk: 7, day: "Fri", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "0mg", ai: "0.25mg", total: "3mL" },
        { date: "21-Apr", wk: 8, day: "Mon", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "23-Apr", wk: 8, day: "Wed", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "25-Apr", wk: 8, day: "Fri", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "28-Apr", wk: 9, day: "Mon", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "30-Apr", wk: 9, day: "Wed", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "2-May", wk: 9, day: "Fri", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "5-May", wk: 10, day: "Mon", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "7-May", wk: 10, day: "Wed", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "9-May", wk: 10, day: "Fri", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "12-May", wk: 11, day: "Mon", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "14-May", wk: 11, day: "Wed", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "16-May", wk: 11, day: "Fri", test: "500mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "19-May", wk: 12, day: "Mon", test: "333mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "21-May", wk: 12, day: "Wed", test: "333mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "23-May", wk: 12, day: "Fri", test: "333mg (2mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "3mL" },
        { date: "26-May", wk: 13, day: "Mon", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "2mL" },
        { date: "28-May", wk: 13, day: "Wed", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "2mL" },
        { date: "30-May", wk: 13, day: "Fri", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "2mL" },
        { date: "2-Jun", wk: 14, day: "Mon", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "2mL" },
        { date: "4-Jun", wk: 14, day: "Wed", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "2mL" },
        { date: "6-Jun", wk: 14, day: "Fri", test: "250mg (1mL)", primo: "100mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "2mL" },
        { date: "9-Jun", wk: 15, day: "Mon", test: "250mg (1mL)", primo: "0mg (1mL)", anavar: "25mg", ai: "0.25mg", total: "1mL" },
        { date: "11-Jun", wk: 15, day: "Wed", test: "250mg (1mL)", primo: "0mg (0mL)", anavar: "25mg", ai: "0.25mg", total: "1mL" },
        { date: "13-Jun", wk: 15, day: "Fri", test: "250mg (1mL)", primo: "0mg (0mL)", anavar: "25mg", ai: "-", total: "1mL" }
    ];

    const App = () => {
        const [completed, setCompleted] = useState(() => JSON.parse(localStorage.getItem('cy_done') || '{}'));
        const [notes, setNotes] = useState(() => JSON.parse(localStorage.getItem('cy_notes') || '{}'));
        const [weights, setWeights] = useState(() => JSON.parse(localStorage.getItem('cy_weights') || '{}'));
        const [week, setWeek] = useState(1);
        const [view, setView] = useState('tracker');

        useEffect(() => { localStorage.setItem('cy_done', JSON.stringify(completed)); }, [completed]);
        useEffect(() => { localStorage.setItem('cy_notes', JSON.stringify(notes)); }, [notes]);
        useEffect(() => { localStorage.setItem('cy_weights', JSON.stringify(weights)); }, [weights]);

        const currentItems = useMemo(() => DATA.filter(d => d.wk === week), [week]);
        const totalDoneCount = Object.values(completed).filter(Boolean).length;
        const progress = Math.round((totalDoneCount / DATA.length) * 100);

        const journalEntries = useMemo(() => {
            return DATA.filter(item => {
                const id = `${item.date}-${item.wk}`;
                return notes[id] && notes[id].trim() !== "";
            });
        }, [notes]);

        const weightData = useMemo(() => {
            const entries = DATA.map(item => {
                const id = `${item.date}-${item.wk}`;
                const weight = weights[id];
                return {
                    date: item.date,
                    day: item.day,
                    wk: item.wk,
                    weight: weight ? parseFloat(weight) : null
                };
            }).filter(entry => entry.weight !== null);

            if (entries.length === 0) return { entries: [], change: 0, percentChange: 0, startWeight: 0, endWeight: 0 };

            const startWeight = entries[0].weight;
            const endWeight = entries[entries.length - 1].weight;
            const change = endWeight - startWeight;
            const percentChange = ((change / startWeight) * 100).toFixed(1);

            return { entries, change, percentChange, startWeight, endWeight };
        }, [weights]);

        return (
            <div className="max-w-md mx-auto min-h-screen flex flex-col pb-24">
                <header className="bg-white p-5 border-b sticky top-0 z-50 shadow-sm">
                    <div className="flex justify-between items-center mb-4">
                        <h1 className="text-xl font-black text-slate-900">
                            <span className="text-blue-600">Cycle</span> Tracker
                        </h1>
                        <div className="flex gap-2">
                            <span className="bg-blue-100 text-blue-700 text-[10px] font-black px-3 py-1 rounded-full uppercase">
                                {progress}% Total
                            </span>
                        </div>
                    </div>
                    <div className="w-full bg-gray-100 h-1.5 rounded-full overflow-hidden">
                        <div className="bg-blue-600 h-full transition-all duration-700 ease-out" style={{width: `${progress}%`}}></div>
                    </div>
                </header>

                {view === 'tracker' ? (
                    <div className="p-4 flex-grow">
                        <div className="flex items-center justify-between mb-6 bg-white p-4 rounded-[2rem] border shadow-sm">
                            <button onClick={() => setWeek(w => Math.max(1, w-1))} className="w-12 h-12 flex items-center justify-center bg-gray-50 rounded-2xl font-bold disabled:opacity-20 active:scale-90" disabled={week===1}>←</button>
                            <div className="text-center">
                                <p className="text-[10px] uppercase font-bold text-gray-400 tracking-widest">Stage</p>
                                <p className="text-xl font-black">WEEK {week}</p>
                            </div>
                            <button onClick={() => setWeek(w => Math.min(15, w+1))} className="w-12 h-12 flex items-center justify-center bg-gray-50 rounded-2xl font-bold disabled:opacity-20 active:scale-90" disabled={week===15}>→</button>
                        </div>

                        <div className="space-y-4">
                            {currentItems.map((item) => {
                                const id = `${item.date}-${item.wk}`;
                                const isDone = completed[id];
                                return (
                                    <div key={id} className={`p-6 rounded-[2.5rem] border transition-all duration-300 ${isDone ? 'bg-green-50/50 border-green-200' : 'bg-white border-gray-100 shadow-sm'}`}>
                                        <div className="flex justify-between items-start mb-5">
                                            <div>
                                                <h2 className="text-xl font-black text-slate-800 tracking-tight">{item.day}, {item.date}</h2>
                                                <p className="text-[10px] font-black text-slate-400 uppercase tracking-widest mt-1">Injection Day</p>
                                            </div>
                                            <button 
                                                onClick={() => setCompleted(prev => ({...prev, [id]: !prev[id]}))}
                                                className={`w-14 h-14 rounded-3xl flex items-center justify-center text-xl transition-all active:scale-75 ${isDone ? 'bg-green-500 text-white shadow-lg shadow-green-200' : 'bg-gray-100 text-gray-300'}`}
                                            >
                                                {isDone ? '✓' : ''}
                                            </button>
                                        </div>

                                        <div className="grid grid-cols-2 gap-2 mb-5">
                                            <Badge label="Test" val={item.test} color="blue" />
                                            <Badge label="Primo" val={item.primo} color="purple" />
                                            <Badge label="Anavar" val={item.anavar} color="orange" />
                                            <Badge label="AI" val={item.ai} color="rose" />
                                        </div>

                                        <div className="mb-5">
                                            <label className="block text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2">Body Weight (lbs)</label>
                                            <input 
                                                type="number"
                                                step="0.1"
                                                value={weights[id] || ''}
                                                onChange={(e) => setWeights(prev => ({...prev, [id]: e.target.value}))}
                                                placeholder="Enter weight..."
                                                className="w-full p-4 bg-gray-50 border border-gray-100 rounded-2xl text-sm outline-none focus:ring-4 focus:ring-blue-500/5 transition-all"
                                            />
                                        </div>

                                        <textarea 
                                            value={notes[id] || ''}
                                            onChange={(e) => setNotes(prev => ({...prev, [id]: e.target.value}))}
                                            placeholder="Log weight, mood..."
                                            className="w-full p-4 bg-gray-50 border border-gray-100 rounded-2xl text-sm outline-none focus:ring-4 focus:ring-blue-500/5 transition-all min-h-[100px] resize-none"
                                        />

                                        <div className="mt-4 pt-4 border-t border-dashed border-gray-200 flex justify-between items-center px-1">
                                            <span className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Total Volume</span>
                                            <span className="text-sm font-black text-slate-800">{item.total}</span>
                                        </div>
                                    </div>
                                )
                            })}
                        </div>
                    </div>
                ) : (
                    <div className="p-4 flex-grow">
                        <h2 className="text-2xl font-black mb-6 px-2">Cycle Summary</h2>
                        <div className="grid grid-cols-2 gap-4 mb-8">
                            <div className="bg-blue-600 p-5 rounded-[2rem] text-white shadow-xl">
                                <p className="text-[10px] font-black opacity-60 uppercase tracking-widest mb-1">Injections</p>
                                <p className="text-3xl font-black">{totalDoneCount}</p>
                                <p className="text-[10px] font-bold opacity-60 mt-1">of {DATA.length}</p>
                            </div>
                            <div className="bg-white p-5 rounded-[2rem] border border-gray-100 shadow-sm">
                                <p className="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">Status</p>
                                <p className="text-3xl font-black text-slate-800">Week {week}</p>
                            </div>
                        </div>

                        {weightData.entries.length > 0 && (
                            <div className="mb-8">
                                <h3 className="text-xs font-black text-slate-400 uppercase tracking-widest px-2 mb-4">Weight Progress</h3>
                                
                                <div className="bg-white p-6 rounded-[2rem] border border-gray-100 shadow-sm mb-4">
                                    <div className="grid grid-cols-3 gap-4 mb-6">
                                        <div>
                                            <p className="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">Start</p>
                                            <p className="text-xl font-black text-slate-800">{weightData.startWeight} lbs</p>
                                        </div>
                                        <div>
                                            <p className="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">Current</p>
                                            <p className="text-xl font-black text-slate-800">{weightData.endWeight} lbs</p>
                                        </div>
                                        <div>
                                            <p className="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">Change</p>
                                            <p className={`text-xl font-black ${weightData.change >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                {weightData.change >= 0 ? '+' : ''}{weightData.change.toFixed(1)} lbs
                                            </p>
                                            <p className={`text-[10px] font-bold ${weightData.change >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                {weightData.change >= 0 ? '+' : ''}{weightData.percentChange}%
                                            </p>
                                        </div>
                                    </div>

                                    <div className="relative h-48">
                                        <svg className="w-full h-full" viewBox="0 0 400 200" preserveAspectRatio="none">
                                            <defs>
                                                <linearGradient id="lineGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                                    <stop offset="0%" style={{stopColor: '#3b82f6', stopOpacity: 1}} />
                                                    <stop offset="100%" style={{stopColor: '#8b5cf6', stopOpacity: 1}} />
                                                </linearGradient>
                                            </defs>
                                            {(() => {
                                                const weights = weightData.entries.map(e => e.weight);
                                                const minWeight = Math.min(...weights);
                                                const maxWeight = Math.max(...weights);
                                                const range = maxWeight - minWeight || 1;
                                                const padding = range * 0.1;
                                                
                                                const points = weightData.entries.map((entry, i) => {
                                                    const x = (i / (weightData.entries.length - 1)) * 400;
                                                    const y = 200 - (((entry.weight - minWeight + padding) / (range + padding * 2)) * 180 + 10);
                                                    return `${x},${y}`;
                                                }).join(' ');

                                                return (
                                                    <>
                                                        <polyline
                                                            points={points}
                                                            fill="none"
                                                            stroke="url(#lineGradient)"
                                                            strokeWidth="3"
                                                            strokeLinecap="round"
                                                            strokeLinejoin="round"
                                                        />
                                                        {weightData.entries.map((entry, i) => {
                                                            const x = (i / (weightData.entries.length - 1)) * 400;
                                                            const y = 200 - (((entry.weight - minWeight + padding) / (range + padding * 2)) * 180 + 10);
                                                            return (
                                                                <circle
                                                                    key={i}
                                                                    cx={x}
                                                                    cy={y}
                                                                    r="4"
                                                                    fill="#3b82f6"
                                                                    stroke="white"
                                                                    strokeWidth="2"
                                                                />
                                                            );
                                                        })}
                                                    </>
                                                );
                                            })()}
                                        </svg>
                                    </div>
                                    <div className="flex justify-between items-center mt-4 pt-4 border-t border-dashed border-gray-200">
                                        <span className="text-[10px] font-black text-slate-400 uppercase tracking-widest">
                                            Week 1
                                        </span>
                                        <span className="text-[10px] font-black text-slate-400 uppercase tracking-widest">
                                            Week {weightData.entries[weightData.entries.length - 1].wk}
                                        </span>
                                    </div>
                                </div>

                                <div className="space-y-3">
                                    {weightData.entries.map((entry, index) => {
                                        const prevWeight = index > 0 ? weightData.entries[index - 1].weight : entry.weight;
                                        const change = entry.weight - prevWeight;
                                        return (
                                            <div key={entry.date} className="bg-white p-4 rounded-2xl border border-gray-100 flex justify-between items-center">
                                                <div>
                                                    <p className="text-sm font-black text-slate-800">{entry.day}, {entry.date}</p>
                                                    <p className="text-[10px] font-bold text-slate-400">Week {entry.wk}</p>
                                                </div>
                                                <div className="text-right">
                                                    <p className="text-lg font-black text-slate-800">{entry.weight} lbs</p>
                                                    {index > 0 && (
                                                        <p className={`text-[10px] font-bold ${change >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                                            {change >= 0 ? '+' : ''}{change.toFixed(1)} lbs
                                                        </p>
                                                    )}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        )}

                        {weightData.entries.length === 0 && (
                            <div className="bg-gray-50 p-8 rounded-3xl border border-dashed border-gray-200 text-center mb-8">
                                <p className="text-gray-400 font-bold">No weight data recorded yet.</p>
                                <p className="text-sm text-gray-400 mt-2">Start logging your weight on injection days to see progress.</p>
                            </div>
                        )}

                        <div className="space-y-6">
                            <h3 className="text-xs font-black text-slate-400 uppercase tracking-widest px-2">Log Timeline</h3>
                            {journalEntries.map(entry => (
                                <div key={entry.date} className="bg-white p-5 rounded-3xl border border-gray-100 shadow-sm">
                                    <div className="flex justify-between items-center mb-2">
                                        <p className="text-sm font-black text-blue-600">{entry.day}, {entry.date}</p>
                                        <span className="text-[10px] font-bold text-gray-400 uppercase">Wk {entry.wk}</span>
                                    </div>
                                    <p className="text-slate-600 text-sm italic">"{notes[`${entry.date}-${entry.wk}`]}"</p>
                                </div>
                            ))}
                            {journalEntries.length === 0 && <p className="text-center text-gray-400 py-10">No notes recorded yet.</p>}
                        </div>
                    </div>
                )}

                <nav className="fixed bottom-0 left-0 right-0 p-4 z-50">
                    <div className="max-w-md mx-auto bg-slate-900 rounded-[2.5rem] p-2 flex gap-2 shadow-2xl">
                        <button onClick={() => setView('tracker')} className={`flex-1 py-4 rounded-[2rem] font-black text-xs uppercase tracking-widest transition-all ${view === 'tracker' ? 'bg-white text-slate-900 shadow-lg' : 'text-white/60 hover:text-white'}`}>Tracker</button>
                        <button onClick={() => setView('summary')} className={`flex-1 py-4 rounded-[2rem] font-black text-xs uppercase tracking-widest transition-all ${view === 'summary' ? 'bg-white text-slate-900 shadow-lg' : 'text-white/60 hover:text-white'}`}>Summary</button>
                    </div>
                </nav>
            </div>
        );
    };

    const Badge = ({ label, val, color }) => {
        const theme = {
            blue: 'bg-blue-50 text-blue-700 border-blue-100',
            purple: 'bg-purple-50 text-purple-700 border-purple-100',
            orange: 'bg-orange-50 text-orange-700 border-orange-100',
            rose: 'bg-rose-50 text-rose-700 border-rose-100',
        }[color];
        return (
            <div className={`p-2.5 rounded-2xl border ${theme}`}>
                <p className="text-[8px] font-black uppercase opacity-50 mb-1">{label}</p>
                <p className="text-xs font-black truncate">{val}</p>
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>


</body>
</html>
